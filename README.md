# Solo Leveling Quests & Skills System

## Project Overview
A dynamic quest and skill progression system inspired by the Solo Leveling concept, built with Go and Supabase.

## Features
- Player creation and management
- Dynamic quest generation
- Skill acquisition system
- Time-based quest progression
- Randomized skill rewards

## Technical Stack
- Backend: Go (Golang)
- Database: Supabase PostgreSQL
- API Framework: Gorilla Mux

## Database Schema Creation

### Players Table
```sql
create table
 public.players (
 id bigint generated by default as identity not null,
name text null,
 gender boolean null,
 joined_at timestamp with time zone not null default (now() at time zone 'utc'::text),
constraint players_pkey primary key (id)
 ) tablespace pg_default;
```

### Quests Table
```sql
create table
 public.quests (
 id bigint generated by default as identity not null,
description text null,
 title text null,
priority smallint null,
constraint quests_pkey primary key (id)
 ) tablespace pg_default;
create index if not exists quests_priority_idx on public.quests using btree (priority) tablespace pg_default;
create index if not exists quests_title_idx on public.quests using btree (title) tablespace pg_default;
```

### Skills Table
```sql
create table
 public.skills (
 id bigint generated by default as identity not null,
name text null,
description text null,
level integer null,
constraint skills_pkey primary key (id)
 ) tablespace pg_default;
create index if not exists skills_level_idx on public.skills using btree (level) tablespace pg_default;
create index if not exists skills_name_idx on public.skills using btree (name) tablespace pg_default;
```

### Player Quests Table
```sql
create table
 public.player_quests (
 id bigint generated by default as identity not null,
 start_at timestamp with time zone not null,
 player bigint null,
 quest bigint null,
status integer not null default 0,
priority integer not null,
constraint player_quests_pkey primary key (id),
constraint player_quests_player_fkey foreign key (player) references players (id) on update cascade on delete cascade,
constraint player_quests_quest_fkey foreign key (quest) references quests (id) on update cascade on delete cascade,
constraint player_quests_finish_check check (
 (
 (status >= '-1'::integer)
and (status <= 1)
 )
 )
 ) tablespace pg_default;
```

### Player Skills Table
```sql
create table
 public.player_skills (
 id bigint generated by default as identity not null,
 recived_at timestamp with time zone not null default (now() at time zone 'utc'::text),
 skill bigint not null,
 player bigint not null,
constraint player_skills_pkey primary key (id),
constraint player_skills_skill_key unique (skill),
constraint player_skills_player_fkey foreign key (player) references players (id) on update cascade on delete cascade,
constraint player_skills_skill_fkey foreign key (skill) references skills (id) on update cascade on delete cascade
 ) tablespace pg_default;
```

## Key Endpoints
- `POST /player`: Create new player
- `GET /player/{id}`: Retrieve player details
- `GET /player/{id}/quests`: Fetch active quests
- `GET /player/{id}/finish/{questId}`: Complete a quest

## Installation
1. Clone the repository
2. Set up Supabase project
3. Create a `.env` file in the root directory with the required environment variables (see below)
4. Configure database connection
5. Run database migrations
6. Start the Go server

### Initializing Default Test Data
After starting the server, you can initialize default test data by sending a request to the `/init` endpoint. This will:
- Read and insert predefined quests from `quests.json`
- Read and insert predefined skills from `skills.json`

To initialize the test data:
```bash
curl http://localhost:8080/api/v1/init
```

Note: Ensure that `quests.json` and `skills.json` files are present in the project root directory before calling the `/init` endpoint.

## Environment Setup
### Required Software
- Go 1.20+
- Supabase account
- PostgreSQL

### Environment Variables
Create a `.env` file in the root project directory with the following variables:
```env
SUPA_URL=your_supabase_database_url
SUPA_KEY=your_supabase_service_role_key
```
You can find these values in your Supabase project dashboard:
1. Go to Project Settings > Database
2. SUPA_URL is your database URL
3. SUPA_KEY is your service role key (make sure to use the service role key, not the anon key)

## Contributing
1. Fork the repository
2. Create feature branch
3. Commit changes
4. Push and create pull request

## License
MIT License